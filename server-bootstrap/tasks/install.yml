---
  #TODO: the script has hardcoded values. Create a module to abstract this functionality.
  - name: Ubuntu | Changing sources to Ubuntu local mirror
    script: configure_sources.sh
    when: bootstrap_local_sources and ansible_distribution == 'Ubuntu'

  - name: Ubuntu | Upgrade system
    apt:
      upgrade=dist
    when: bootstrap_upgrade_system and ansible_distribution == 'Ubuntu'

  - name: Amazon | Add EPEL repository
    yum:
      name=epel-release
      state=present
    when: ansible_distribution == 'Amazon'

  - name: Ubuntu | Installing essential packages to build and run software
    apt:
      pkg={{item}}
      state=latest
      update_cache=yes
    with_items:
      - build-essential
      - bzip2
      - curl
      - libssl-dev
      - locales
      - ntp
      - openssl
      - python-software-properties
      - ssl-cert
      - wget
    when: ansible_distribution == 'Ubuntu'

  - name: FreeBSD | Installing essential packages to build and run software
    pkgng:
      name={{item}}
      state=present
    with_items:
      - bzip2
      - curl
      - openssl
      - wget
      - rsync
    when: ansible_distribution == 'FreeBSD'

  - name: Amazon | Install the 'Development tools' package group
    yum:
      name="@Development tools"
      state=present
      enablerepo=epel
    when: ansible_distribution == 'Amazon'

  - name: Ubuntu | Installing useful packages for development in the server
    apt:
      pkg={{item}}
      state=latest
      update_cache=yes
    with_items:
      - bash
      - git
      - htop
      - silversearcher-ag
      - vim
      - tree
      - multitail
      - unzip
    when: bootstrap_install_dev_packages and ansible_distribution == 'Ubuntu'

  - name: FreeBSD | Installing useful packages for development in the server
    pkgng:
      pkg={{item}}
      state=present
    with_items:
      - git
      - htop
      - the_silver_searcher
      - vim-lite
      - tree
      - multitail
      - unzip
    when: bootstrap_install_dev_packages and ansible_distribution == 'FreeBSD'

  - name: Amazon | Installing useful packages for development in the server
    yum:
      name={{item}}
      state=latest
      update_cache=yes
      enablerepo=epel
    with_items:
      - git
      - htop
      - vim
      - tree
      - multitail
      - wget
      - unzip
    when: bootstrap_install_dev_packages and ansible_distribution == 'Amazon'

  - name: Adding nagios plugin
    apt:
      pkg=nagios-plugins
      state=latest
      update_cache=yes
      install_recommends=no
    when: bootstrap_nagios

  - name: Ubuntu | Adding mosh PPA
    apt_repository:
      repo="ppa:keithw/mosh"
      update_cache=yes
    when: bootstrap_install_mosh and ansible_distribution == 'Ubuntu'

  - name: Ubuntu | Installing mosh
    apt:
      pkg=mosh
      state=latest
      update_cache=yes
      install_recommends=no
    when: bootstrap_install_mosh and ansible_distribution == 'Ubuntu'

  - name: Ubuntu | Enabling port(s) for mosh in ufw
    ufw:
      rule=allow
      port="60000:61000"
      proto=udp
    when: bootstrap_install_mosh and ansible_distribution == 'Ubuntu'
