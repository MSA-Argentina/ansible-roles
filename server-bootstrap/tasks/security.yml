---
  - name: bootstrap | Installing security packages
    apt:
      pkg={{item}}
      state=latest
    with_items:
      - fail2ban
      - ufw

  - name: bootstrap | Installing unattended-upgrades
    apt:
      pkg=unattended-upgrades
      state=latest

  - name: bootstrap | Copying unattended upgrades config files
    template:
      src={{item}}
      dest=/etc/apt/apt.conf.d/{{item}}
      owner=root
      group=root
      mode=700
    with_items:
      - 10periodic
      - 50unattended-upgrades

  - name: bootstrap | Enabling ufw
    ufw:
      state: "{{bootstrap_ufw_state}}"

  - name: bootstrap | Enabling ssh in ufw
    ufw:
      rule=allow
      name=OpenSSH

  - name: bootstrap | Enabling port(s) in ufw
    ufw:
      rule=allow
      port={{item}}
    with_items: "{{bootstrap_ufw_allowed_ports}}"

